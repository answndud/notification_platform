# Chapter 01 - Redis란 무엇이고, 왜 필요한가

- 상태: 초안 완료
- 목표 분량: 10쪽

## 학습 목표

- Redis를 초보자 관점에서 한 문장으로 설명할 수 있다.
- Redis, 관계형 데이터베이스(RDBMS), 메시지 브로커의 역할 차이를 구분할 수 있다.
- Redis를 써야 하는 경우와 피해야 하는 경우를 판단할 수 있다.

## 핵심 개념: Redis는 무엇인가

Redis는 메모리 기반 데이터 구조 저장소(in-memory data structure store)입니다.
쉽게 말해, "키(key)로 매우 빠르게 읽고 쓰는 서버"입니다.

Redis라는 이름은 Remote Dictionary Server에서 왔습니다.
여기서 dictionary는 key-value 접근 모델을 뜻합니다.

중요한 점은 Redis가 단순 캐시 상자만은 아니라는 것입니다.
캐시, 세션 저장소, 토큰 저장소, 카운터, 랭킹, 임시 상태 저장 등 다양한 역할을 할 수 있습니다.

## Redis가 빠른 이유

Redis가 빠른 이유는 크게 세 가지입니다.

1. 메모리 중심 처리
- 대부분의 연산이 RAM에서 이루어져 디스크 I/O 대기가 작습니다.

2. 단순한 접근 패턴
- 키 기반 단건 조회/갱신이 많아 연산 비용이 예측 가능하고 빠릅니다.

3. 효율적인 통신 모델
- 파이프라이닝 같은 기법으로 네트워크 왕복 비용을 줄일 수 있습니다.

단, "빠르다"는 말이 "설계 없이 써도 안전하다"는 뜻은 아닙니다.
키 설계와 TTL 정책이 나쁘면 운영 중 장애가 쉽게 발생합니다.

## Redis vs RDBMS vs 메시지 브로커

### Redis vs RDBMS

- Redis: 짧은 수명, 높은 조회 빈도, 키 중심 접근에 강함
- RDBMS: 강한 정합성, 조인, 장기 보관, 복잡 조회에 강함

실무 분리 예시:
- 사용자 기본 정보(권위 데이터) -> RDBMS
- 로그인 토큰/세션(휘발성 데이터) -> Redis

### Redis vs 메시지 브로커

- Kafka/RabbitMQ 같은 브로커는 내구성 있는 이벤트 전파와 재처리 체계에 강합니다.
- Redis도 Pub/Sub, Streams를 제공하지만, 보장 수준과 운영 생태계가 다릅니다.

실무 분리 예시:
- 서비스 간 핵심 이벤트 백본 -> Kafka
- 로컬 실시간 알림/경량 신호 전달 -> Redis Pub/Sub(조건부)

## 대표 사용 사례

1. 캐시
- 비용이 큰 조회 결과를 TTL과 함께 저장해 DB 부하를 줄입니다.

2. 세션/토큰 저장
- 만료가 중요한 인증 데이터를 빠르게 조회/삭제합니다.

3. 카운터/레이트 리밋
- 원자적 증가 연산과 만료를 결합해 요청 제한을 구현합니다.

4. 랭킹
- Sorted Set으로 점수 기반 순위를 관리합니다.

5. 임시 상태 저장
- 작업 진행 상태를 짧은 수명으로 보관합니다.

## Redis가 1순위가 아닌 경우

1. 장기 정합성과 감사 추적이 핵심인 금융 원장성 데이터
2. 조인/복합 검색이 핵심인 관계형 도메인
3. 메모리 계획 없이 무기한 보관이 필요한 데이터

이 경우 Redis는 보조 역할(캐시/가속)로 두는 것이 일반적입니다.

## 초보자를 위한 설계 질문 3개

Redis 도입 전, 최소한 아래 질문에 답해야 합니다.

1. 데이터 수명: 이 데이터는 몇 초/분/시간 살아야 하는가?
2. 접근 패턴: 단건 키 조회인가, 복잡 조회인가?
3. 장애 전략: Redis 장애 시 서비스는 어떻게 동작해야 하는가?

이 세 가지가 불명확하면 초기 개발은 빨라도 운영 단계에서 비용이 커집니다.

## 실습 예제

### 예제 A: key-value 기본 감각

```bash
redis-cli -p 6380
SET demo:user:1 "kim"
GET demo:user:1
DEL demo:user:1
```

관찰 포인트:
- `SET`: 키에 값 저장
- `GET`: 같은 키로 값 조회
- `DEL`: 키 삭제

### 예제 B: 만료가 있는 토큰 저장

```bash
SET auth:refresh:user1 token-value EX 1200
TTL auth:refresh:user1
```

관찰 포인트:
- `EX 1200`: 1200초 뒤 자동 만료
- `TTL`: 남은 수명 확인

## 자주 하는 실수

1. "Redis는 캐시만 한다"고 단정한다.
- 실제로는 캐시 외 역할도 가능하지만, 각 역할마다 설계 기준이 필요합니다.

2. "빠르니까 설계는 나중"이라고 생각한다.
- 키 규칙과 TTL 누락은 가장 흔한 장애 원인입니다.

3. "데이터를 다 Redis에 넣으면 된다"고 생각한다.
- 메모리 비용과 데이터 성격을 먼저 따져야 합니다.

## 요약

- Redis는 메모리 기반의 빠른 키-중심 저장소다.
- 짧은 수명/고빈도/단건 접근 데이터에 특히 강하다.
- 권위 데이터와 복잡 조회는 RDBMS 같은 적합한 저장소에 둔다.
- Redis의 성패는 도구 선택보다 키/TTL/장애 설계에 달려 있다.

## 연습문제

### 기초

1. Redis를 비개발자에게 1문장으로 설명해보세요.
2. RDBMS가 Redis보다 적합한 사례를 1개 적어보세요.

### 응용

1. 본인 서비스 API 하나를 골라 Redis 적용 여부를 근거와 함께 설명해보세요.
2. "Redis가 5분간 장애" 상황에서의 동작 정책을 5줄로 작성해보세요.

## 챕터 체크리스트

- [x] 초안 작성 완료
- [x] 예제 명령어 검증 완료
- [x] 초보자 기준 용어 설명 완료
- [x] 최종 교정 완료
